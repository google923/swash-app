<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#0078d7" />
  <title>SMS Centre - Swash Subscriber</title>
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./assets/favicon-192.png" type="image/png" />
  <link rel="stylesheet" href="./style.css" />
  <style>
    .admin-only, .rep-only, .admin-rep { display: none !important; }
    .subscriber-only { display: block !important; }
    .sms-grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:16px; }
    .sms-card { border:1px solid #e2e8f0; border-radius:10px; padding:18px; background:#fff; display:flex; flex-direction:column; gap:12px; }
    .sms-card h3 { margin:0; font-size:1.1rem; color:#1e293b; }
    .sms-card p { margin:0; color:#475569; font-size:0.95rem; }
    .sms-card strong { color:#0f172a; }
    .package-grid { display:grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap:16px; }
    .package-card { border:2px solid #e2e8f0; border-radius:12px; padding:20px; background:#fff; display:flex; flex-direction:column; gap:12px; transition:border-color 0.2s, box-shadow 0.2s, transform 0.2s; }
    .package-card:hover { border-color:#0078d7; box-shadow:0 10px 25px rgba(0,120,215,0.12); transform:translateY(-2px); }
    .package-meta { font-size:0.9rem; color:#64748b; }
    .balance-display { font-size:2.6rem; font-weight:700; color:#0078d7; }
    .balance-sub { font-size:0.9rem; color:#64748b; }
    .history-list { display:flex; flex-direction:column; gap:12px; }
    .history-item { border:1px solid #e2e8f0; border-radius:10px; padding:14px 16px; background:#f8fafc; display:flex; flex-direction:column; gap:6px; }
    .history-item strong { color:#0f172a; }
    .history-status { font-weight:600; font-size:0.85rem; padding:4px 8px; border-radius:999px; display:inline-flex; align-items:center; gap:6px; }
    .history-status[data-status="pending"] { background:#fef9c3; color:#92400e; }
    .history-status[data-status="completed"] { background:#dcfce7; color:#166534; }
    .history-status[data-status="failed"] { background:#fee2e2; color:#991b1b; }
    .notice { padding:12px 14px; background:#f0fdf4; border:1px solid #86efac; border-radius:8px; font-size:0.95rem; color:#166534; margin-top:12px; }
    .error { padding:12px 14px; background:#fee2e2; border:1px solid #fca5a5; border-radius:8px; font-size:0.95rem; color:#991b1b; margin-top:12px; }
    @media (max-width: 640px) {
      .balance-display { font-size:2.2rem; }
    }
  </style>
</head>
<body>



  <section id="authOverlay" class="auth-overlay" aria-live="polite">
    <div class="auth-card">
      <h2>Checking authentication...</h2>
      <p class="text-muted">Please wait while we verify your account.</p>
    </div>
  </section>

  <main id="smsContent" class="page" style="display:none;">

    <section class="card">
      <header class="card-header">
        <div class="card-header-main">
          <h2>Your SMS Balance</h2>
          <p class="text-muted">Manage your sender name, remaining credits, and top-ups.</p>
        </div>
      </header>
      <div class="card-body sms-grid" style="gap:20px;">
        <div class="sms-card">
          <span class="balance-sub">Current credits</span>
          <span id="creditsBalance" class="balance-display">0</span>
          <span class="balance-sub" id="lastTopUp">Last top-up: â€”</span>
        </div>
        <div class="sms-card">
          <h3>Sender ID</h3>
          <p>Set the name that appears on outgoing SMS messages (max 11 letters or numbers).</p>
          <form id="senderForm" autocomplete="off" spellcheck="false" style="display:flex; flex-direction:column; gap:12px;">
            <label style="display:flex; flex-direction:column; gap:6px; font-weight:600; color:#0f172a;">
              <span>Sender name</span>
              <input id="senderName" maxlength="11" placeholder="SWASHCLEAN" style="padding:10px 12px;border:1px solid #cbd5e1;border-radius:8px;font-weight:500;letter-spacing:1px;text-transform:uppercase;" />
            </label>
            <button type="submit" id="saveSenderBtn" class="btn btn-primary">Save sender name</button>
            <p id="senderStatus" style="margin:0;font-size:0.85rem;color:#64748b;"></p>
          </form>
        </div>
      </div>
    </section>

    <section class="card" style="margin-top:24px;">
      <header class="card-header">
        <div class="card-header-main">
          <h2>Buy SMS Credits</h2>
          <p class="text-muted">Secure payment via GoCardless Instant Bank Pay. Credits are applied automatically after payment confirmation.</p>
        </div>
      </header>
      <div class="card-body">
        <div id="purchaseFeedback"></div>
        <div id="packagesContainer" class="package-grid" style="margin-top:12px;"></div>
      </div>
    </section>

    <section class="card" style="margin-top:24px;">
      <header class="card-header">
        <div class="card-header-main">
          <h2>Purchase History</h2>
          <p class="text-muted">Track recent top-ups and their status.</p>
        </div>
      </header>
      <div class="card-body">
        <div id="historyContainer" class="history-list"></div>
      </div>
    </section>

  </main>

  <script type="module" src="./subscriber-sms-setup.js"></script>
</body>
</html>

